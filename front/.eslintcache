[{"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\index.js":"1","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\App.js":"2","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\pages\\Home.js":"3","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\pages\\Profil.js":"4","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\pages\\Connexion.js":"5","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Navbar.js":"6","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Thread.js":"7","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\NewPostForm.js":"8","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\Logout.js":"9","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Profil\\UpdateProfil.js":"10","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\index.js":"11","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Utils.js":"12","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\Card.js":"13","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Profil\\UploadImg.js":"14","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\SignInForm.js":"15","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\SignUpForm.js":"16","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\DeleteCard.js":"17","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\LikeButton.js":"18","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\CardComments.js":"19","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\DeleteComment.js":"20"},{"size":320,"mtime":1712240130728,"results":"21","hashOfConfig":"22"},{"size":539,"mtime":1728641910435,"results":"23","hashOfConfig":"22"},{"size":1245,"mtime":1728655806613,"results":"24","hashOfConfig":"22"},{"size":236,"mtime":1713880511348,"results":"25","hashOfConfig":"22"},{"size":263,"mtime":1713309547387,"results":"26","hashOfConfig":"22"},{"size":1204,"mtime":1728642484156,"results":"27","hashOfConfig":"22"},{"size":750,"mtime":1728656718696,"results":"28","hashOfConfig":"22"},{"size":4606,"mtime":1729388071758,"results":"29","hashOfConfig":"22"},{"size":460,"mtime":1728645981877,"results":"30","hashOfConfig":"22"},{"size":4368,"mtime":1728922182586,"results":"31","hashOfConfig":"22"},{"size":1109,"mtime":1728651873916,"results":"32","hashOfConfig":"22"},{"size":1076,"mtime":1728655185171,"results":"33","hashOfConfig":"22"},{"size":6287,"mtime":1729634965244,"results":"34","hashOfConfig":"22"},{"size":2216,"mtime":1728915041950,"results":"35","hashOfConfig":"22"},{"size":2892,"mtime":1728653976560,"results":"36","hashOfConfig":"22"},{"size":3202,"mtime":1728653735415,"results":"37","hashOfConfig":"22"},{"size":818,"mtime":1729182894641,"results":"38","hashOfConfig":"22"},{"size":2109,"mtime":1729731812142,"results":"39","hashOfConfig":"22"},{"size":3987,"mtime":1729185962016,"results":"40","hashOfConfig":"22"},{"size":1396,"mtime":1729183008410,"results":"41","hashOfConfig":"22"},{"filePath":"42","messages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"20gtdg",{"filePath":"45","messages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"47","messages":"48","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"49","messages":"50","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"53","messages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"55","messages":"56","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"57","messages":"58","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"59","messages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"61","messages":"62","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"63","messages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"65","messages":"66","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"67","messages":"68","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"69","usedDeprecatedRules":"44"},{"filePath":"70","messages":"71","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"72","messages":"73","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"74","messages":"75","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"76","messages":"77","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"78","messages":"79","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"80","messages":"81","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"82","messages":"83","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\index.js",[],["84","85"],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\App.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\pages\\Home.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\pages\\Profil.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\pages\\Connexion.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Navbar.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Thread.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\NewPostForm.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\Logout.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Profil\\UpdateProfil.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\index.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Utils.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\Card.js",["86","87"],"import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { dateParser, isEmpty } from \"../Utils\";\r\nimport LikeButton from \"./LikeButton\";\r\nimport DeleteCard from \"./DeleteCard\";\r\nimport CardComments from \"./CardComments\";\r\n\r\nconst Card = ({ post, reloadPosts }) => {\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isUpdated, setIsUpdated] = useState(false);\r\n  const [textUpdate, setTextUpdate] = useState(null);\r\n  const [usersData, setUsersData] = useState([]);\r\n  const [userData, setUserData] = useState([]);\r\n  const userId = localStorage.getItem(\"userId\");\r\n  const token = localStorage.getItem(\"token\");\r\n  //const [attachmentUpdate, setAttachmentUpdate] = useState();\r\n\r\n  const updateItem = () => {\r\n    // Envoi de la mise à jour du texte si l'état textUpdate est non null\r\n    if (textUpdate) {\r\n      //setAttachmentUpdate(post.attachment);\r\n      console.log(\"post1\", post);\r\n      //console.log(\"updateItem\", attachmentUpdate);\r\n\r\n      return axios({\r\n        method: \"put\",\r\n        url: `${process.env.REACT_APP_API_URL}api/post/${post.id}`,\r\n        data: { file: post.attachment, content: textUpdate },\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      })\r\n        .then((res) => {\r\n          console.log(\"res.data de updateItem :\", res.data);\r\n          setIsUpdated(false);\r\n          reloadPosts();\r\n        })\r\n        .catch((err) => console.log(err));\r\n    }\r\n    console.log(\"post.attachment\", post.attachment);\r\n    setIsUpdated(false);\r\n  };\r\n\r\n  // Execution de la récuperation des données utilisateurs uniquement au premier chargement de la fonction Card\r\n  useEffect(() => {\r\n    const getUsersData = () => {\r\n      axios\r\n        .get(`${process.env.REACT_APP_API_URL}api/user/`)\r\n        .then((res) => {\r\n          setUsersData(res.data);\r\n        })\r\n        .catch((err) => console.log(err));\r\n    };\r\n\r\n    getUsersData();\r\n  }, []);\r\n\r\n  // Execution de la récuperation des données d'un utilisateur dès que l'userId change\r\n  useEffect(() => {\r\n    const getUserData = () => {\r\n      axios\r\n        .get(`${process.env.REACT_APP_API_URL}api/user/` + userId)\r\n        .then((res) => {\r\n          setUserData(res.data);\r\n        })\r\n        .catch((err) => console.log(err));\r\n    };\r\n\r\n    getUserData();\r\n  }, [userId]);\r\n\r\n  // On desactive le loader dès que les données utilisateurs sont chargées\r\n  useEffect(() => {\r\n    if (!isEmpty(usersData)) {\r\n      setIsLoading(false);\r\n    }\r\n  }, [usersData]);\r\n\r\n  console.log(\"res.usersData\", usersData);\r\n\r\n  return (\r\n    <li className=\"card-container\">\r\n      {isLoading ? (\r\n        <i className=\"fas fa-spinner fa-spin\"></i>\r\n      ) : (\r\n        <>\r\n          <div className=\"card-left\">\r\n            <img\r\n              src={\r\n                // Vérification de la présence des données pour éviter une erreur\r\n                !isEmpty(usersData[0]) &&\r\n                // Affichage de la photo utilisateur si l'id correspond à l'user_id du post sinon rien\r\n                usersData\r\n                  .map((user) => {\r\n                    if (user.id === post.user_id) return user.attachment;\r\n                    return null;\r\n                  })\r\n                  // Utilisation de join pour fixer le problème des virgules générées par map dans le rendu\r\n                  .join(\"\")\r\n              }\r\n              alt=\"poster-pic\"\r\n            />\r\n          </div>\r\n          <div className=\"card-right\">\r\n            <div className=\"card-header\">\r\n              <div className=\"pseudo\">\r\n                <h3>\r\n                  {!isEmpty(usersData[0]) &&\r\n                    usersData\r\n                      .map((user) => {\r\n                        if (user.id === post.user_id) return user.username;\r\n                        else return null;\r\n                      })\r\n                      .join(\"\")}\r\n                </h3>\r\n              </div>\r\n              {/* Affichage et formatage de la date */}\r\n              <span>{dateParser(post.createdAt)}</span>\r\n            </div>\r\n            {isUpdated === false && <p>{post.content}</p>}\r\n            {/* {isUpdated && (\r\n              <div className=\"update-post\">\r\n                <textarea\r\n                  defaultValue={post.content}\r\n                  onChange={(e) => setTextUpdate(e.target.value)}\r\n                />\r\n                <div className=\"button-container\">\r\n                  <button className=\"btn\" onClick={updateItem}>\r\n                    Valider modification\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}{\" \"} */}\r\n            {post.attachment && (\r\n              <img src={post.attachment} alt=\"card-pic\" className=\"card-pic\" />\r\n            )}\r\n            {post.video && (\r\n              <iframe\r\n                width=\"500\"\r\n                height=\"300\"\r\n                src={post.video}\r\n                frameBorder=\"0\"\r\n                allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\r\n                allowFullScreen\r\n                title={post._id}\r\n              ></iframe>\r\n            )}\r\n            {/* Implémentation des droits admin ou user pour la suppression d'un post*/}\r\n            {userData.is_admin ? (\r\n              <div className=\"button-container\">\r\n                <DeleteCard\r\n                  post={post}\r\n                  reloadPosts={reloadPosts}\r\n                  id={post.user_id}\r\n                />\r\n              </div>\r\n            ) : (\r\n              userData.id === post.user_id && (\r\n                <div className=\"button-container\">\r\n                  {/* <div onClick={() => setIsUpdated(!isUpdated)}>\r\n                    <img src=\"./img/edit.svg\" alt=\"edit\" />\r\n                  </div> */}\r\n                  <DeleteCard\r\n                    post={post}\r\n                    reloadPosts={reloadPosts}\r\n                    id={post.user_id}\r\n                  />\r\n                </div>\r\n              )\r\n            )}\r\n            <div className=\"card-footer\">\r\n              <LikeButton post={post} />\r\n            </div>\r\n            <CardComments postId={post.id} />\r\n          </div>\r\n        </>\r\n      )}\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default Card;\r\n","D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Profil\\UploadImg.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\SignInForm.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Log\\SignUpForm.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\DeleteCard.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\LikeButton.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\CardComments.js",[],"D:\\Temp\\Site web\\FabienD_7_01032024\\front\\src\\components\\Post\\DeleteComment.js",[],{"ruleId":"88","replacedBy":"89"},{"ruleId":"90","replacedBy":"91"},{"ruleId":"92","severity":1,"message":"93","line":11,"column":22,"nodeType":"94","messageId":"95","endLine":11,"endColumn":35},{"ruleId":"92","severity":1,"message":"96","line":18,"column":9,"nodeType":"94","messageId":"95","endLine":18,"endColumn":19},"no-native-reassign",["97"],"no-negated-in-lhs",["98"],"no-unused-vars","'setTextUpdate' is assigned a value but never used.","Identifier","unusedVar","'updateItem' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]